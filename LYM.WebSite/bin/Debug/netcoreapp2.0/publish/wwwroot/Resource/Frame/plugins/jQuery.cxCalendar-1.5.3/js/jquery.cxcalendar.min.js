/*!
 * jQuery cxCalendar
 * @name jquery.cxcalendar.js
 * @version 1.5.3
 * @date 2016-08-04
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxCalendar
 * @license Released under the MIT license
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){a.cxCalendar=function(){var b={dom:{},api:{}};return b.init=function(){var c,d,g,h,b=this,e=function(a){return a&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&a instanceof HTMLElement?!0:a&&a.nodeType&&1===a.nodeType?!0:!1},f=function(a){return a&&a.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&a instanceof jQuery?!0:!1};for(g=0,h=arguments.length;h>g;g++)f(arguments[g])?b.dom.el=arguments[g]:e(arguments[g])?b.dom.el=a(arguments[g]):"function"==typeof arguments[g]?d=arguments[g]:"object"==typeof arguments[g]&&(c=arguments[g]);b.dom.el.length&&(b.settings=a.extend({},a.cxCalendar.defaults,c,{startDate:b.dom.el.data("startDate"),endDate:b.dom.el.data("endDate"),type:b.dom.el.data("type"),format:b.dom.el.data("format"),wday:b.dom.el.data("wday"),position:b.dom.el.data("position"),baseClass:b.dom.el.data("baseClass"),language:b.dom.el.data("language")}),b.isIE=!!window.ActiveXObject||document.documentMode,b.isIE6=document.all&&!window.XMLHttpRequest,b.isFF=!!window.sidebar,b.reg={isYear:/^\d{4}$/,isMonthOrDay:/^\d{1,2}$/},b.setOptions(),b.build(!0),b.api={show:function(){b.show()},hide:function(){b.hide()},getDate:function(){return b.getDate.apply(b,arguments)},setDate:function(){b.setDate.apply(b,arguments)},gotoDate:function(){b.gotoDate.apply(b,arguments)},clearDate:function(){b.clearDate()},setOptions:function(){b.setOptions.apply(b,arguments),b.build()}},"function"==typeof d&&d(b.api))},b.getLanguage=function(b){return"object"==typeof b?b:("string"!=typeof b&&("string"==typeof navigator.language?b=navigator.language:"string"==typeof navigator.browserLanguage&&(b=navigator.browserLanguage)),"string"==typeof b&&(b=b.toLowerCase()),"string"==typeof b&&"object"==typeof a.cxCalendar.languages[b]?a.cxCalendar.languages[b]:a.cxCalendar.languages["default"])},b.setOptions=function(b){var d,e,f,g,h,c=this;if("object"==typeof b&&a.extend(c.settings,b),c.dom.el.val().length&&(c.settings.date=c.dom.el.val()),c.cacheDay=c.formatDate("YYYY-M-D",c.settings.date),d=c.reg.isYear.test(c.settings.startDate)?new Date(c.settings.startDate,0,1):new Date(c.getDateValue(c.settings.startDate)),e=c.reg.isYear.test(c.settings.endDate)?new Date(c.settings.endDate,11,31):new Date(c.getDateValue(c.settings.endDate)),(isNaN(d.getTime())||isNaN(e.getTime())||d.getFullYear()>e.getFullYear())&&(d=new Date(a.cxCalendar.defaults.startDate,0,1),e=new Date(a.cxCalendar.defaults.endDate,11,31)),c.minDate={year:d.getFullYear(),month:d.getMonth()+1,hour:d.getHours(),mint:d.getMinutes(),secs:d.getSeconds(),time:d.getTime()},c.maxDate={year:e.getFullYear(),month:e.getMonth()+1,hour:e.getHours(),mint:e.getMinutes(),secs:e.getSeconds(),time:e.getTime()},f=c.settings.date?new Date(c.getDateValue(c.settings.date)):new Date,isNaN(f.getTime())&&(f=new Date),c.defDate=f.getTime()<c.minDate.time?a.extend({},c.minDate):f.getTime()>c.maxDate.time?a.extend({},c.maxDate):{year:f.getFullYear(),month:f.getMonth()+1,hour:f.getHours(),mint:f.getMinutes(),secs:f.getSeconds(),time:f.getTime()},c.settings.saturday=6-c.settings.wday,c.settings.sunday=7-c.settings.wday>=7?0:7-c.settings.wday,c.language=c.getLanguage(c.settings.language),a.isArray(c.language.holiday)&&c.language.holiday.length)for(c.holiday={},g=0,h=c.language.holiday.length;h>g;g++)c.holiday[c.language.holiday[g].day]=c.language.holiday[g].name;else c.holiday=null},b.getMonthDays=function(a){var b=0===a%4&&0!==a%100||0===a%400?1:0;return[31,28+b,31,30,31,30,31,31,30,31,30,31]},b.getDateValue=function(a){var b=this;return b.reg.isYear.test(a)?a+="/1/1":"number"==typeof a&&isFinite(a)?a=parseInt(a,10):"string"==typeof a&&(a=a.replace(/[\.\-]/g,"/")),a},b.getTimeValue=function(a,b){var c,d;return a=parseInt(a,10),c=0,d=59,"hour"===b&&(d=23),isNaN(a)?a=c:c>a?a=d:a>d&&(a=c),10>a?"0"+a:a},b.formatDate=function(a,b){var c,d;return"string"!=typeof a||"undefined"===b?b:(b=this.getDateValue(b),c=new Date(b),d={},isNaN(c.getTime())?b:(d.YYYY=c.getFullYear(),d.YY=d.YYYY.toString(10).slice(-2),d.M=c.getMonth()+1,d.MM=d.M<10?"0"+d.M:d.M,d.D=c.getDate(),d.DD=d.D<10?"0"+d.D:d.D,d.H=c.getHours(),d.HH=d.H<10?"0"+d.H:d.H,d.h=d.H>12?d.H-12:d.H,d.hh=d.h<10?"0"+d.h:d.h,d.m=c.getMinutes(),d.mm=d.m<10?"0"+d.m:d.m,d.s=c.getSeconds(),d.ss=d.s<10?"0"+d.s:d.s,d.time=c.getTime(),d.string=c.toDateString(),a=a.replace(/TIME/g,d.time),a=a.replace(/YYYY/g,d.YYYY),a=a.replace(/YY/g,d.YY),a=a.replace(/MM/g,d.MM),a=a.replace(/M/g,d.M),a=a.replace(/DD/g,d.DD),a=a.replace(/D/g,d.D),a=a.replace(/HH/g,d.HH),a=a.replace(/H/g,d.H),a=a.replace(/hh/g,d.hh),a=a.replace(/h/g,d.h),a=a.replace(/mm/g,d.mm),a=a.replace(/m/g,d.m),a=a.replace(/ss/g,d.ss),a=a.replace(/s/g,d.s),a=a.replace(/STRING/g,d.string)))},b.build=function(b){var d,e,c=this;for(b===!0&&(c.dom.pane=a("<div></div>",{"class":"cxcalendar"}),c.dom.paneHd=a("<div></div>",{"class":"cxcalendar_hd"}).appendTo(c.dom.pane).html('<a class="prev" href="javascript://" rel="prev"></a><a class="next" href="javascript://" rel="next"></a>'),c.dom.paneBd=a("<div></div>",{"class":"cxcalendar_bd"}).appendTo(c.dom.pane),c.dom.paneFt=a("<div></div>",{"class":"cxcalendar_ft"}).appendTo(c.dom.pane),c.dom.dateTxt=a("<div></div>",{"class":"intxt"}).appendTo(c.dom.paneHd),c.dom.dateSet=a("<div></div>",{"class":"inset"}).appendTo(c.dom.paneHd),c.dom.yearSet=a("<select></select>",{"class":"year"}).appendTo(c.dom.dateSet),c.dom.monthSet=a("<select></select>",{"class":"month"}).appendTo(c.dom.dateSet),c.dom.weekSet=a("<ul></ul>",{"class":"week"}).appendTo(c.dom.paneBd),c.dom.daySet=a("<ul></ul>",{"class":"days"}).appendTo(c.dom.paneBd),c.dom.dayTxt=a("<div></div>",{"class":"inday"}).appendTo(c.dom.paneFt),c.dom.timeSet=a("<div></div>",{"class":"intime"}).appendTo(c.dom.paneFt),c.dom.hourSet=a("<input/>",{type:"text","class":"hour",maxlength:"2"}).html(d).appendTo(c.dom.timeSet),c.dom.mintSet=a("<input/>",{type:"text","class":"mint",maxlength:"2"}).html(d).appendTo(c.dom.timeSet).before("<i>:</i>"),c.dom.secsSet=a("<input/>",{type:"text","class":"secs",maxlength:"2"}).html(d).appendTo(c.dom.timeSet).before("<i>:</i>"),c.dom.paneFt.append('<a class="confirm" href="javascript://" rel="confirm"></a>')),"datetime"!==c.settings.type?c.dom.paneFt.hide():c.dom.paneFt.show(),d="",e=c.minDate.year;e<=c.maxDate.year;e++)d+='<option value="'+e+'">'+e+"</option>";for(c.dom.yearSet.html(d).val(c.defDate.year),d="",e=0;12>e;e++)d+='<option value="'+(e+1)+'">'+c.language.monthList[e]+"</option>";for(c.dom.monthSet.html(d).val(c.defDate.month),c.dom.hourSet.val(c.getTimeValue(c.defDate.hour,"hour")),c.dom.mintSet.val(c.getTimeValue(c.defDate.mint,"mint")),c.dom.secsSet.val(c.getTimeValue(c.defDate.secs,"secs")),d="",e=0;7>e;e++)d+="<li",e===c.settings.saturday?d+=' class="sat"':e===c.settings.sunday&&(d+=' class="sun"'),d+=">",d+=e+c.settings.wday<7?c.language.weekList[e+c.settings.wday]:c.language.weekList[e+c.settings.wday-7],d+="</li>";c.dom.weekSet.html(d),"string"==typeof c.settings.baseClass&&c.dom.pane.attr("class","cxcalendar").addClass(c.settings.baseClass),c.gotoDate(c.defDate.year,c.defDate.month),b===!0&&(c.dom.pane.appendTo("body"),c.dom.blockBg=a("<div></div>",{"class":"cxcalendar_lock"}).appendTo("body"),c.bindEvents())},b.bindEvents=function(){var c,b=this;b.dom.el.on("focus",function(){b.show()}),b.dom.blockBg.on("click",function(){b.hide()}),b.dom.dateTxt.on("click",function(){b.dom.dateTxt.hide(),b.dom.dateSet.show()}),b.dom.pane.on("click","a",function(a){switch(this.rel){case"prev":a.preventDefault(),b.gotoDate(b.dom.yearSet.val(),parseInt(b.dom.monthSet.val(),10)-1);break;case"next":a.preventDefault(),b.gotoDate(b.dom.yearSet.val(),parseInt(b.dom.monthSet.val(),10)+1);break;case"confirm":a.preventDefault(),"string"==typeof b.cacheDay&&b.cacheDay.length&&b.setDate(b.cacheDay+" "+[b.dom.hourSet.val(),b.dom.mintSet.val(),b.dom.secsSet.val()].join(":"))}}),b.dom.pane.on("change","select",function(){var a=this.getAttribute("class")||this.getAttribute("classname");("year"===a||"month"===a)&&b.gotoDate(b.dom.yearSet.val(),b.dom.monthSet.val())}),b.dom.daySet.on("click","li",function(){var c=a(this);c.hasClass("del")||(c.addClass("selected").siblings("li").removeClass("selected"),b.cacheDay=[c.data("year"),c.data("month"),c.data("day")].join("-"),b.dom.dayTxt.html(b.cacheDay),"date"===b.settings.type&&b.setDate(c.data("year"),c.data("month"),c.data("day")))}),b.dom.dayTxt.on("click",function(){b.gotoDate(b.getDateValue(this.innerHTML))}),b.dom.pane.on("mouseup","input",function(){var a=this.getAttribute("class")||this.getAttribute("classname");("hour"===a||"mint"===a||"secs"===a)&&this.select()}),c=b.isFF?"DOMMouseScroll":"mousewheel",b.dom.pane.on(c,"input",function(a){var c,d,e;a.preventDefault(),c=this.getAttribute("class")||this.getAttribute("classname"),d=parseInt(this.value,10),e=b.isFF?-a.originalEvent.detail:a.originalEvent.wheelDelta,("hour"===c||"mint"===c||"secs"===c)&&(e>0?d+=1:0>e&&(d-=1),d=b.getTimeValue(d,c),this.value=d)}),b.dom.pane.on("keydown","input",function(a){var c=this.getAttribute("class")||this.getAttribute("classname"),d=parseInt(this.value,10);("hour"===c||"mint"===c||"secs"===c)&&(38===a.keyCode||40===a.keyCode)&&(38===a.keyCode?d+=a.shiftKey?10:1:d-=a.shiftKey?10:1,d=b.getTimeValue(d,c),this.value=d)}),b.dom.pane.on("blur","input",function(){var c=this.getAttribute("class")||this.getAttribute("classname"),d=parseInt(this.value,10);("hour"===c||"mint"===c||"secs"===c)&&(d=b.getTimeValue(d,c),this.value=d)})},b.rebulidMonthSelect=function(a,b){var f,c=a||1,d=b||12,e="";for(f=c;d>=f;f++)e+='<option value="'+f+'">'+this.language.monthList[f-1]+"</option>";this.dom.monthSet.html(e)},b.show=function(){var a=this,b=a.settings.position,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=a.dom.pane.outerWidth(),f=a.dom.pane.outerHeight(),g=a.dom.el[0].getBoundingClientRect().top,h=a.dom.el[0].getBoundingClientRect().left,i=a.dom.el.offset().top,j=a.dom.el.offset().left,k=a.dom.el.outerWidth(),l=a.dom.el.outerHeight(),m=g+l+f>d?i-f:i+l,n=h+e>c?j-e-k:j;if("string"==typeof b&&b.length)switch(b){case"top":m=i-f;break;case"topLeft":case"topRight":m=i-f,n="topLeft"===b?j-e+k:j;break;case"bottom":m=i+l;break;case"bottomLeft":case"bottomRight":m=i+l,n="bottomLeft"===b?j-e+k:j;break;case"left":case"right":m=g+l+f>d?i+l-f:i,n="left"===b?j-e:j+k;break;case"leftTop":case"leftBottom":m="leftTop"===b?i+l-f:i,n=j-e;break;case"rightTop":case"rightBottom":m="rightTop"===b?i+l-f:i,n=j+k}a.dom.dateTxt.html('<span class="y">'+a.dom.yearSet.val()+'</span><span class="m">'+a.language.monthList[parseInt(a.dom.monthSet.val(),10)-1]+"</span>"),a.dom.pane.css({top:m,left:n}).show(),a.isIE6&&a.dom.blockBg.css({width:c,height:d}),a.dom.blockBg.show()},b.hide=function(){var a=this;a.dom.pane.hide(),a.dom.blockBg.hide(),a.dom.dateSet.hide(),a.dom.dateTxt.show()},b.gotoDate=function(a,b){var d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,c=this;if(d=c.reg.isYear.test(a)&&c.reg.isMonthOrDay.test(b)?new Date(a,b-1,1):new Date(c.getDateValue(a)),!isNaN(d.getTime())){for(e=d.getFullYear(),f=d.getMonth()+1,_theTime=d.getTime(),e<c.minDate.year||e<=c.minDate.year&&f<c.minDate.month?(e=c.minDate.year,f=c.minDate.month):(e>c.maxDate.year||e>=c.maxDate.year&&f>c.maxDate.month)&&(e=c.maxDate.year,f=c.maxDate.month),e===c.minDate.year&&e===c.maxDate.year?c.rebulidMonthSelect(c.minDate.month,c.maxDate.month):e===c.minDate.year?c.rebulidMonthSelect(c.minDate.month,12):e===c.maxDate.year?c.rebulidMonthSelect(1,c.maxDate.month):c.rebulidMonthSelect(),g=f-1,h=c.getMonthDays(e),i=new Date(e,g,1),new Date(e,f,1),k=new Date,l=k.getFullYear(),m=k.getMonth()+1,n=k.getDate(),"string"==typeof c.cacheDay&&c.cacheDay.length&&(o=new Date(c.getDateValue(c.cacheDay)),isNaN(o.getTime())||(p=o.getFullYear(),q=o.getMonth()+1,r=o.getDate())),s=i.getDay()-c.settings.wday,0>s&&(s+=7),t=7*Math.ceil((h[g]+s)/7),A="",B=0;t>B;B++)z="",y=[],v=e,w=f,u=B-s+1,0>=u?(y.push("other"),1>=w?(v--,w=12,u=h[11]+u):(w--,u=h[g-1]+u)):u>h[g]&&(y.push("other"),w>=12?(v++,w=1,u-=h[0]):(w++,u-=h[g])),x=new Date(v,w-1,u).getTime(),"object"==typeof o&&v===p&&w===q&&u===r?y.push("selected"):v===l&&w===m&&u===n&&y.push("now"),B%7===c.settings.saturday?y.push("sat"):B%7===c.settings.sunday&&y.push("sun"),(x<c.minDate.time||x>c.maxDate.time)&&y.push("del"),z=v+"-"+w+"-"+u,c.holiday&&("string"==typeof c.holiday["M"+w+"-"+u]?(y.push("holiday"),z=c.holiday["M"+w+"-"+u]):"string"==typeof c.holiday["D"+v+"-"+w+"-"+u]&&(y.push("holiday"),z=c.holiday["D"+v+"-"+w+"-"+u])),A+="<li",y.length&&(A+=' class="'+y.join(" ")+'"'),A+=' title="'+z+'"',A+=' data-year="'+v+'" data-month="'+w+'" data-day="'+u+'">'+u+"</li>";c.dom.daySet.html(A),c.dom.dateTxt.html('<span class="y">'+e+'</span><span class="m">'+c.language.monthList[g]+"</span>"),c.dom.yearSet.val(e),c.dom.monthSet.val(f)}},b.getDate=function(a){var b=this.dom.el.val();return"string"==typeof a&&a.length||(a=this.settings.format),b=this.formatDate(a,b)},b.setDate=function(a,b,c){var e,f,g,h,i,d=this;e=d.reg.isYear.test(a)&&d.reg.isMonthOrDay.test(b)&&d.reg.isMonthOrDay.test(c)?new Date(a,b-1,c):new Date(d.getDateValue(a)),isNaN(e.getTime())||(f=e.getFullYear(),g=e.getMonth()+1,h=e.getDate(),_theTime=e.getTime(),i=d.formatDate(d.settings.format,_theTime),d.cacheDay=[f,g,h].join("-"),d.dom.el.val(i).trigger("change"),d.hide(),d.gotoDate(f,g))},b.clearDate=function(){this.dom.el.val(""),this.hide()},b.init.apply(b,arguments),this},a.cxCalendar.defaults={startDate:1950,endDate:2030,date:void 0,type:"date",format:"YYYY-MM-DD",wday:0,position:void 0,baseClass:void 0,language:void 0},a.cxCalendar.languages={"default":{monthList:["1","2","3","4","5","6","7","8","9","10","11","12"],weekList:["日","一","二","三","四","五","六"],holiday:[]}},a.fn.cxCalendar=function(b,c){return this.each(function(){a.cxCalendar(this,b,c)}),this}});